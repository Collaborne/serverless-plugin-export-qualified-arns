dist: trusty
group: beta
language: node_js
node_js:
- node
cache:
  directories:
  - node_modules
before_install:
- if [ -d node_modules ] && [ x$(cat node_modules/.last-node-version 2>/dev/null) != x$(node -e 'console.log(process.version)') ]; then npm rebuild --update-binary && node -e 'console.log(process.version)' > node_modules/.last-node-version; fi
script:
- npm test
deploy:
  provider: npm
  email: npm@collaborne.com
  api_key:
    secure: "V9rMGsYHUGczRqk54KFgyXXBo/Eu639l2nyaltKliuQfCVCV5offeXsab2hJpEo7llHcCv8Pv1ef9SEQdLsrPBu8O4e99U0hOBy6n57la1IEFZmFhmqjLEZ/NYzCMtxFUVYx7Mt945jpyDtC8hNVoyvmJOq+ElGqrkdWDJt/ZK3HQ0vFpj5XvX0qtQ5FhDSdJUxcgVNfnEu2Id3lHdC9k4i+Olt7hk3vjADZYGriEl7DXw3/NtjDRXc4RQOk65t5OJcBUV9SfzXw2vrlEi0XentR0Pu7MQcccFDPajQUzwN30lMr61aMn10CmHypG5DVhtNJjcrq1U4P1U182YvohkXN7j2D0Z17eSmgvbunebbACgmQtJ/tYQ+NWmeFIwNIAQrR6XJLn1eKcytq8Yrf4YMTe6mSK/488rmchniMn0lwXyxayCGLvDsCF7fU7AakYcNRxV8a6ehuF09Um+d0bMrFG8vEX7th+zgKpFPwaumU3RB0sVwTG/d4w5u6GW4CMCDPBIUma5zP+dODY3ItFgyI859yMzK822QFJckg6MfCzE8K5Knpd9FMqKhbJIDEUX6GxgBa8vJjjyHX7w8Wx2wWCsNOIoBDtOOuYc3WloU/0zr4PWQjizGwv76qzAeXvenuzY1pzVZYW+9W1d75X4/rBrXKUwobW6FyhCmJPk0="
  on:
    tags: true
    condition: $(node -e 'console.log("v" + require("./package.json").version)') = ${TRAVIS_TAG}
  skip_cleanup: true
